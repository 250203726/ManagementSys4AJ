<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>富文本编辑器</title>
	<meta charset="utf-8" />
    <link rel="stylesheet" href="themes/default/default.css" />
    <link rel="stylesheet" href="plugins/code/prettify.css" />
    <script src="../../assets/lib/jquery/jquery-1.9.0.min.js" type="text/javascript"></script> 
    <script charset="utf-8" src="kindeditor.js"></script>
    <script charset="utf-8" src="lang/zh_CN.js"></script>
    <script charset="utf-8" src="plugins/code/prettify.js"></script>
    
    <script src="../../assets/js/Util.js"></script>
    <script type="text/javascript">
        var KE;
        $(function () {
            KindEditor.ready(function (K) {
                KE = K.create('#kinde_content', {
                    cssPath: 'plugins/code/prettify.css',
                    uploadJson: 'KindeHandler.ashx?oprtype=upload',
                    fileManagerJson: 'KindeHandler.ashx?oprtype=manger',
                    allowFileManager: true,
                    afterCreate: function () {
                        //var self = this;
                        //K.ctrl(document, 13, function () {
                        //    self.sync();
                        //    K('form[name=example]')[0].submit();
                        //});
                        //K.ctrl(self.edit.doc, 13, function () {
                        //    self.sync();
                        //    K('form[name=example]')[0].submit();
                        //});
                    }
                });
                prettyPrint();
            });
        })

    </script>
    <script type="text/javascript">
        $(function() {
            $(document).on("click", "input[name=btn_submit]", function () {
                var post_data = {};
                post_data.title = $("input[name=title]").val();
                post_data.art_type = $("select[name=art_type] option:selected").val();
                post_data.content = KE.html();
                var Rtn = GetDataByAjax("../../NB_JsonHttp.aspx", "SAVEARTICLE", "", "", JSON.stringify(post_data));
                if (Rtn.result) {
                    console.log("新增成功。");
                }
            });
        });
    </script>
</head>
<body>
    <form id="art_form" action="" method="post">
        <input type="text" name="title" value="" />
        <select name="art_type">
            <option value="岗位职责">岗位职责</option>
            <option value="部门职责">部门职责</option>
        </select>
        <textarea name="kinde_content" id="kinde_content" cols="100" rows="8" style="width:700px;height:200px;visibility:hidden;"></textarea>

        <input type="button" name="btn_submit" value="保存" />
    </form>
</body>
</html>
